{% extends 'dashboard/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">

  <div class="text-center mb-4">
    <img src="{% static 'mfheader.png' %}" alt="Header" class="img-fluid" style="max-height: 120px;">
    <h2>Add New Player</h2>
  </div>

  {% if form.errors %}
    <div class="alert alert-danger">
      <strong>Form has errors:</strong>
      <ul>
        {% for field in form %}
          {% for error in field.errors %}
            <li><strong>{{ field.label }}:</strong> {{ error }}</li>
          {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form method="post">
    {% csrf_token %}
    <div class="row">
      <!-- ðŸ§ Left Column -->
      <div class="col-md-6">
        <div class="border rounded shadow-sm p-3">
          <div class="mb-3"><label>Player Name *</label>{{ form.player_name }}</div>
          <div class="mb-3"><label>Address *</label>{{ form.player_address }}</div>

          <!-- Gender Dropdown -->
          <div class="mb-3">
            <label>Gender</label>
            <select name="gender_id" id="gender_id" class="form-select form-select-sm">
              {% for g in all_genders %}
                <option value="{{ g.gender_id }}">{{ g.gender_name }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="mb-3" id="gender_specify_block" style="display: none;">
            <label>Specify Gender</label>{{ form.gender_specify }}
          </div>

          <div class="mb-3"><label>Email *</label>{{ form.player_email }}</div>
          <div class="mb-3"><label>Date of Birth</label>{{ form.player_dob }}</div>
          <div class="mb-3"><label>Primary Contact Number *</label>{{ form.player_primary_mobile_number }}</div>
          <div class="mb-3"><label>Primary Contact *</label>{{ form.player_contact_name1 }}</div>
          <div class="mb-3"><label>Secondary Contact Number</label>{{ form.player_secundary_mobile_number }}</div>
          <div class="mb-3"><label>Secondary Contact</label>{{ form.player_contact_name2 }}</div>
        </div>
      </div>

      <!-- ðŸ“‹ Right Column -->
      <div class="col-md-6">
        <div class="border rounded shadow-sm p-3">
          <div class="mb-3"><label>Active</label>{{ form.player_active }}</div>
          <div class="mb-3"><label>Transfer Out</label>{{ form.player_transfer_out }}</div>
          <div class="mb-3"><label>Membership (â‚¬)</label>{{ form.player_membership_amount }}</div>
          <div class="mb-3"><label>BI Number</label>{{ form.player_bi_number }}</div>
          <div class="mb-3"><label>Jersey #</label>{{ form.player_jersey }}</div>

          <!-- Team Dropdown -->
          <div class="mb-3">
            <label>Team</label>
            <select name="team" class="form-select form-select-sm">
              {% for team in all_teams %}
                <option value="{{ team.teams_id }}">{{ team.teams_name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Role Dropdown -->
          <div class="mb-3">
            <label>Role</label>
            <select name="role" class="form-select form-select-sm">
              {% for role in all_roles %}
                <option value="{{ role.role_id }}">{{ role.role_name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="mb-3"><label>Medical Conditions</label>{{ form.player_medical_conditions }}</div>
          <div class="mb-3"><label>Training?</label>{{ form.participation_member_training }}</div>
          <div class="mb-3"><label>Play Matches?</label>{{ form.participation_member_play_matches }}</div>
          <div class="mb-3"><label>Other Activities</label>{{ form.participation_member_other_activities }}</div>
          <div class="mb-3"><label>Committee Member</label>{{ form.player_committee_member }}</div>
          <div class="mb-3"><label>Member 1</label>{{ form.player_member_1 }}</div>
          <div class="mb-3"><label>Member 2</label>{{ form.player_member_2 }}</div>
          <div class="mb-3"><label>Member 3</label>{{ form.player_member_3 }}</div>
          <div class="mb-3"><label>Photo Consent</label>{{ form.photo_cons }}</div>
        </div>
      </div>
    </div>

    <!-- ðŸ’¾ Save Buttons -->
    <div class="text-center mt-4 mb-4">
      <button type="submit" class="btn btn-success">Add Player</button>
      <a href="{% url 'player_list' %}" class="btn btn-secondary ms-2">Cancel</a>
    </div>
  </form>

  <!-- Dynamic Gender Toggle -->
  <script>
    document.getElementById("gender_id").addEventListener("change", function() {
      const block = document.getElementById("gender_specify_block");
      const val = parseInt(this.value);
      block.style.display = (![0, 1, 2].includes(val)) ? "block" : "none";
    });
  </script>

</div>
{% endblock %}